<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Bithumb Mobile Trader</title>

<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
    padding: 18px;
    margin: 0;
    background: #f6f6f6;
  }

  h2 {
    margin-top: 30px;
    font-size: 20px;
    color: #333;
  }

  .card {
    background: white;
    padding: 16px;
    border-radius: 14px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    margin-bottom: 25px;
  }

  input, select {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: 1px solid #ddd;
    margin-bottom: 12px;
    font-size: 16px;
    background: #fff;
  }

  button {
    width: 100%;
    padding: 14px;
    font-size: 17px;
    background: #ff6b00;
    color: white;
    border: none;
    border-radius: 12px;
    margin-top: 10px;
  }

  button:active {
    opacity: 0.7;
  }

  .secondary {
    background: #333;
  }

  pre {
    padding: 16px;
    background: #1e1e1e;
    color: #00ff9b;
    border-radius: 10px;
    white-space: pre-wrap;
    font-size: 13px;
    overflow-x: auto;
  }
</style>
</head>
<body>

<h1 style="font-size:24px;">ğŸ“± Bithumb Mobile Trader</h1>

<div class="card">
  <h2>ğŸ” API ì„¤ì •</h2>
  <input id="apiKey" placeholder="API Key ì…ë ¥">
  <input id="apiSecret" placeholder="Secret Key ì…ë ¥">
</div>

<div class="card">
  <h2>ğŸ’° ì”ê³  ì¡°íšŒ</h2>
  <select id="balanceCurrency">
    <option value="ALL">ALL</option>
    <option value="BTC">BTC</option>
    <option value="ETH">ETH</option>
  </select>
  <button class="secondary" onclick="getBalance()">ì”ê³  ì¡°íšŒ</button>
  <pre id="balanceResult"></pre>
</div>

<div class="card">
  <h2>ğŸ›’ ì§€ì •ê°€ ì£¼ë¬¸</h2>

  <label>ì½”ì¸</label>
  <select id="orderCurrency">
    <option value="BTC">BTC</option>
    <option value="ETH">ETH</option>
  </select>

  <label>ì‹œì¥í†µí™”</label>
  <select id="paymentCurrency">
    <option value="KRW">KRW</option>
    <option value="BTC">BTC</option>
  </select>

  <label>ìˆ˜ëŸ‰</label>
  <input id="units" placeholder="ì˜ˆ: 0.001">

  <label>ê°€ê²© (KRW)</label>
  <input id="price" placeholder="ì˜ˆ: 50000000">

  <label>ë§¤ë§¤ íƒ€ì…</label>
  <select id="orderType">
    <option value="bid">ë§¤ìˆ˜ (bid)</option>
    <option value="ask">ë§¤ë„ (ask)</option>
  </select>

  <button onclick="placeOrder()">ì£¼ë¬¸ ì‹¤í–‰</button>
  <pre id="orderResult"></pre>
</div>


<script>
function urlencode(params) {
  return Object.entries(params)
    .map(([k, v]) => encodeURIComponent(k) + "=" + encodeURIComponent(v))
    .join("&");
}

async function hmacSHA512(secret, message) {
  const key = await crypto.subtle.importKey(
    "raw",
    new TextEncoder().encode(secret),
    { name: "HMAC", hash: "SHA-512" },
    false,
    ["sign"]
  );

  const signature = await crypto.subtle.sign(
    "HMAC",
    key,
    new TextEncoder().encode(message)
  );

  return Array.from(new Uint8Array(signature))
    .map(b => b.toString(16).padStart(2, "0"))
    .join("");
}

async function callBithumb(endpoint, params) {
  const apiKey = document.getElementById("apiKey").value.trim();
  const apiSecret = document.getElementById("apiSecret").value.trim();

  if (!apiKey || !apiSecret) {
    alert("API Keyì™€ Secretì„ ì…ë ¥í•˜ì„¸ìš”.");
    return;
  }

  const nonce = Date.now().toString();
  const query = urlencode(params);
  const data = `${endpoint}\u0000${query}\u0000${nonce}`;

  const hex = await hmacSHA512(apiSecret, data);
  const apiSign = btoa(hex);

  const res = await fetch("https://api.bithumb.com" + endpoint, {
    method: "POST",
    headers: {
      "Api-Key": apiKey,
      "Api-Nonce": nonce,
      "Api-Sign": apiSign,
      "Content-Type": "application/x-www-form-urlencoded",
      Accept: "application/json"
    },
    body: query
  });

  return await res.json();
}

async function getBalance() {
  const currency = document.getElementById("balanceCurrency").value;

  const result = await callBithumb("/info/balance", { currency });
  document.getElementById("balanceResult").textContent =
    JSON.stringify(result, null, 2);
}

async function placeOrder() {
  const params = {
    order_currency: document.getElementById("orderCurrency").value,
    payment_currency: document.getElementById("paymentCurrency").value,
    units: document.getElementById("units").value.trim(),
    price: document.getElementById("price").value.trim(),
    type: document.getElementById("orderType").value
  };

  const result = await callBithumb("/trade/place", params);
  document.getElementById("orderResult").textContent =
    JSON.stringify(result, null, 2);
}
</script>

</body>
</html>
