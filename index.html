<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Bithumb Mobile Market Trader</title>

<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
    padding: 18px;
    margin: 0;
    background: #f6f6f6;
  }

  h2 {
    margin-top: 30px;
    font-size: 20px;
    color: #333;
  }

  .card {
    background: white;
    padding: 16px;
    border-radius: 14px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    margin-bottom: 25px;
  }

  input, select {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: 1px solid #ddd;
    margin-bottom: 12px;
    font-size: 16px;
    background: #fff;
  }

  button {
    width: 100%;
    padding: 14px;
    font-size: 17px;
    background: #ff6b00;
    color: white;
    border: none;
    border-radius: 12px;
    margin-top: 10px;
  }

  button:active { opacity: 0.7; }

  .secondary { background: #333; }

  pre {
    padding: 16px;
    background: #1e1e1e;
    color: #00ff9b;
    border-radius: 10px;
    white-space: pre-wrap;
    font-size: 13px;
    overflow-x: auto;
  }
</style>
</head>
<body>

<h1 style="font-size:24px;">ğŸ“± Bithumb Market Trader</h1>

<div class="card">
  <h2>ğŸ” API ì„¤ì •</h2>
  <input id="apiKey" placeholder="API Key ì…ë ¥">
  <input id="apiSecret" placeholder="Secret Key ì…ë ¥">
</div>

<div class="card">
  <h2>ğŸ’° ì‹œì¥ê°€ ì£¼ë¬¸</h2>

  <label>ì½”ì¸ ì„ íƒ</label>
  <select id="orderCurrency">
    <option value="BTC">BTC</option>
    <option value="ETH">ETH</option>
    <option value="SOL">SOL</option>
  </select>

  <label>ì£¼ë¬¸ íƒ€ì…</label>
  <select id="orderType">
    <option value="market_buy">ì‹œì¥ê°€ ë§¤ìˆ˜</option>
    <option value="market_sell">ì‹œì¥ê°€ ë§¤ë„</option>
  </select>

  <label>KRW ê¸ˆì•¡ (ì‹œì¥ê°€ ë§¤ìˆ˜ ì‹œ ì…ë ¥)</label>
  <input id="krwAmount" placeholder="ì˜ˆ: 10000 (ë§¤ìˆ˜ ì‹œ í•„ìˆ˜)">
  
  <button onclick="marketOrder()">ì‹œì¥ê°€ ì£¼ë¬¸ ì‹¤í–‰</button>

  <pre id="orderResult"></pre>
</div>

<script>
// ------------------------------------
// ê³µìš© í•¨ìˆ˜
// ------------------------------------
function urlencode(params) {
  return Object.entries(params)
    .map(([k, v]) => encodeURIComponent(k) + "=" + encodeURIComponent(v))
    .join("&");
}

async function hmacSHA512(secret, message) {
  const key = await crypto.subtle.importKey(
    "raw",
    new TextEncoder().encode(secret),
    { name: "HMAC", hash: "SHA-512" },
    false,
    ["sign"]
  );

  const signature = await crypto.subtle.sign(
    "HMAC",
    key,
    new TextEncoder().encode(message)
  );

  return Array.from(new Uint8Array(signature))
    .map(b => b.toString(16).padStart(2, "0"))
    .join("");
}

async function callBithumb(endpoint, params) {
  const apiKey = document.getElementById("apiKey").value.trim();
  const apiSecret = document.getElementById("apiSecret").value.trim();

  const nonce = Date.now().toString();
  const query = urlencode(params);
  const data = `${endpoint}\u0000${query}\u0000${nonce}`;

  const hex = await hmacSHA512(apiSecret, data);
  const apiSign = btoa(hex);

  const res = await fetch("https://api.bithumb.com" + endpoint, {
    method: "POST",
    headers: {
      "Api-Key": apiKey,
      "Api-Nonce": nonce,
      "Api-Sign": apiSign,
      "Content-Type": "application/x-www-form-urlencoded",
      Accept: "application/json"
    },
    body: query
  });

  return await res.json();
}

// ------------------------------------
// ë³´ìœ ëŸ‰ ì¡°íšŒ (ì‹œì¥ê°€ ë§¤ë„ ì „ìš©)
// ------------------------------------
async function getBalance(currency)
